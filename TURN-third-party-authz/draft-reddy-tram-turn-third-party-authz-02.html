<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>TURN Extension for Third Party Authorization</title>

  <style type="text/css" title="Xml2Rfc (sans serif)">
  /*<![CDATA[*/
	  a {
	  text-decoration: none;
	  }
      /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
      a.info {
          /* This is the key. */
          position: relative;
          z-index: 24;
          text-decoration: none;
      }
      a.info:hover {
          z-index: 25;
          color: #FFF; background-color: #900;
      }
      a.info span { display: none; }
      a.info:hover span.info {
          /* The span will display just on :hover state. */
          display: block;
          position: absolute;
          font-size: smaller;
          top: 2em; left: -5em; width: 15em;
          padding: 2px; border: 1px solid #333;
          color: #900; background-color: #EEE;
          text-align: left;
      }
	  a.smpl {
	  color: black;
	  }
	  a:hover {
	  text-decoration: underline;
	  }
	  a:active {
	  text-decoration: underline;
	  }
	  address {
	  margin-top: 1em;
	  margin-left: 2em;
	  font-style: normal;
	  }
	  body {
	  color: black;
	  font-family: verdana, helvetica, arial, sans-serif;
	  font-size: 10pt;
	  max-width: 55em;
	  
	  }
	  cite {
	  font-style: normal;
	  }
	  dd {
	  margin-right: 2em;
	  }
	  dl {
	  margin-left: 2em;
	  }
	
	  ul.empty {
	  list-style-type: none;
	  }
	  ul.empty li {
	  margin-top: .5em;
	  }
	  dl p {
	  margin-left: 0em;
	  }
	  dt {
	  margin-top: .5em;
	  }
	  h1 {
	  font-size: 14pt;
	  line-height: 21pt;
	  page-break-after: avoid;
	  }
	  h1.np {
	  page-break-before: always;
	  }
	  h1 a {
	  color: #333333;
	  }
	  h2 {
	  font-size: 12pt;
	  line-height: 15pt;
	  page-break-after: avoid;
	  }
	  h3, h4, h5, h6 {
	  font-size: 10pt;
	  page-break-after: avoid;
	  }
	  h2 a, h3 a, h4 a, h5 a, h6 a {
	  color: black;
	  }
	  img {
	  margin-left: 3em;
	  }
	  li {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol p {
	  margin-left: 0em;
	  }
	  p {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  pre {
	  margin-left: 3em;
	  background-color: lightyellow;
	  padding: .25em;
	  }
	  pre.text2 {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f0f0f0;
	  width: 69em;
	  }
	  pre.inline {
	  background-color: white;
	  padding: 0em;
	  }
	  pre.text {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  width: 69em;
	  }
	  pre.drawing {
	  border-style: solid;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  padding: 2em;
	  }
	  table {
	  margin-left: 2em;
	  }
	  table.tt {
	  vertical-align: top;
	  }
	  table.full {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.headers {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.tt td {
	  vertical-align: top;
	  }
	  table.full td {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.tt th {
	  vertical-align: top;
	  }
	  table.full th {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.headers th {
	  border-style: none none inset none;
	  border-width: 1px;
	  }
	  table.left {
	  margin-right: auto;
	  }
	  table.right {
	  margin-left: auto;
	  }
	  table.center {
	  margin-left: auto;
	  margin-right: auto;
	  }
	  caption {
	  caption-side: bottom;
	  font-weight: bold;
	  font-size: 9pt;
	  margin-top: .5em;
	  }
	
	  table.header {
	  border-spacing: 1px;
	  width: 95%;
	  font-size: 10pt;
	  color: white;
	  }
	  td.top {
	  vertical-align: top;
	  }
	  td.topnowrap {
	  vertical-align: top;
	  white-space: nowrap; 
	  }
	  table.header td {
	  background-color: gray;
	  width: 50%;
	  }
	  table.header a {
	  color: white;
	  }
	  td.reference {
	  vertical-align: top;
	  white-space: nowrap;
	  padding-right: 1em;
	  }
	  thead {
	  display:table-header-group;
	  }
	  ul.toc, ul.toc ul {
	  list-style: none;
	  margin-left: 1.5em;
	  margin-right: 0em;
	  padding-left: 0em;
	  }
	  ul.toc li {
	  line-height: 150%;
	  font-weight: bold;
	  font-size: 10pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  ul.toc li li {
	  line-height: normal;
	  font-weight: normal;
	  font-size: 9pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  li.excluded {
	  font-size: 0pt;
	  }
	  ul p {
	  margin-left: 0em;
	  }
	
	  .comment {
	  background-color: yellow;
	  }
	  .center {
	  text-align: center;
	  }
	  .error {
	  color: red;
	  font-style: italic;
	  font-weight: bold;
	  }
	  .figure {
	  font-weight: bold;
	  text-align: center;
	  font-size: 9pt;
	  }
	  .filename {
	  color: #333333;
	  font-weight: bold;
	  font-size: 12pt;
	  line-height: 21pt;
	  text-align: center;
	  }
	  .fn {
	  font-weight: bold;
	  }
	  .hidden {
	  display: none;
	  }
	  .left {
	  text-align: left;
	  }
	  .right {
	  text-align: right;
	  }
	  .title {
	  color: #990000;
	  font-size: 18pt;
	  line-height: 18pt;
	  font-weight: bold;
	  text-align: center;
	  margin-top: 36pt;
	  }
	  .vcardline {
	  display: block;
	  }
	  .warning {
	  font-size: 14pt;
	  background-color: yellow;
	  }
	
	
	  @media print {
	  .noprint {
		display: none;
	  }
	
	  a {
		color: black;
		text-decoration: none;
	  }
	
	  table.header {
		width: 90%;
	  }
	
	  td.header {
		width: 50%;
		color: black;
		background-color: white;
		vertical-align: top;
		font-size: 12pt;
	  }
	
	  ul.toc a::after {
		content: leader('.') target-counter(attr(href), page);
	  }
	
	  ul.ind li li a {
		content: target-counter(attr(href), page);
	  }
	
	  .print2col {
		column-count: 2;
		-moz-column-count: 2;
		column-fill: auto;
	  }
	  }
	
	  @page {
	  @top-left {
		   content: "Internet-Draft"; 
	  } 
	  @top-right {
		   content: "December 2010"; 
	  } 
	  @top-center {
		   content: "Abbreviated Title";
	  } 
	  @bottom-left {
		   content: "Doe"; 
	  } 
	  @bottom-center {
		   content: "Expires June 2011"; 
	  } 
	  @bottom-right {
		   content: "[Page " counter(page) "]"; 
	  } 
	  }
	
	  @page:first { 
		@top-left {
		  content: normal;
		}
		@top-right {
		  content: normal;
		}
		@top-center {
		  content: normal;
		}
	  }
  /*]]>*/
  </style>

  <link href="#rfc.toc" rel="Contents"/>
<link href="#rfc.section.1" rel="Chapter" title="1 Introduction"/>
<link href="#rfc.section.2" rel="Chapter" title="2 Terminology"/>
<link href="#rfc.section.3" rel="Chapter" title="3 Solution Overview"/>
<link href="#rfc.section.4" rel="Chapter" title="4 Obtaining a Token Using OAuth"/>
<link href="#rfc.section.4.1" rel="Chapter" title="4.1 Key Establishment"/>
<link href="#rfc.section.4.1.1" rel="Chapter" title="4.1.1 DSKPP"/>
<link href="#rfc.section.4.1.2" rel="Chapter" title="4.1.2 HTTP interactions"/>
<link href="#rfc.section.4.1.3" rel="Chapter" title="4.1.3 Manual provisioning"/>
<link href="#rfc.section.5" rel="Chapter" title="5 Forming a Request"/>
<link href="#rfc.section.6" rel="Chapter" title="6 STUN Attributes"/>
<link href="#rfc.section.6.1" rel="Chapter" title="6.1 THIRD-PARTY-AUTHORIZATION"/>
<link href="#rfc.section.6.2" rel="Chapter" title="6.2 ACCESS-TOKEN"/>
<link href="#rfc.section.7" rel="Chapter" title="7 Receiving a request with ACCESS-TOKEN attribute"/>
<link href="#rfc.section.8" rel="Chapter" title="8 Changes to TURN Client"/>
<link href="#rfc.section.9" rel="Chapter" title="9 Security Considerations"/>
<link href="#rfc.section.10" rel="Chapter" title="10 IANA Considerations"/>
<link href="#rfc.section.11" rel="Chapter" title="11 Acknowledgements"/>
<link href="#rfc.references" rel="Chapter" title="12 References"/>
<link href="#rfc.references.1" rel="Chapter" title="12.1 Normative References"/>
<link href="#rfc.references.2" rel="Chapter" title="12.2 Informative References"/>
<link href="#rfc.authors" rel="Chapter"/>


  <meta name="generator" content="xml2rfc version 2.4.5 - http://tools.ietf.org/tools/xml2rfc" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />

  <meta name="dct.creator" content="Reddy, T., Patil, P., Ravindranath, R., and J. Uberti" />
  <meta name="dct.identifier" content="urn:ietf:id:draft-reddy-tram-turn-third-party-authz-02" />
  <meta name="dct.issued" scheme="ISO8601" content="2014-5-12" />
  <meta name="dct.abstract" content="This document proposes the use of OAuth to obtain and validate ephemeral tokens that can be used for TURN authentication. The usage of ephemeral tokens ensure that access to a TURN server can be controlled even if the tokens are compromised, as is the case in WebRTC where TURN credentials must be specified in Javascript." />
  <meta name="description" content="This document proposes the use of OAuth to obtain and validate ephemeral tokens that can be used for TURN authentication. The usage of ephemeral tokens ensure that access to a TURN server can be controlled even if the tokens are compromised, as is the case in WebRTC where TURN credentials must be specified in Javascript." />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
  <td class="left">TRAM</td>
  <td class="right">T. Reddy</td>
</tr>
<tr>
  <td class="left">Internet-Draft</td>
  <td class="right">P. Patil</td>
</tr>
<tr>
  <td class="left">Intended status: Standards Track</td>
  <td class="right">R. Ravindranath</td>
</tr>
<tr>
  <td class="left">Expires: November 13, 2014</td>
  <td class="right">Cisco</td>
</tr>
<tr>
  <td class="left"></td>
  <td class="right">J. Uberti</td>
</tr>
<tr>
  <td class="left"></td>
  <td class="right">Google</td>
</tr>
<tr>
  <td class="left"></td>
  <td class="right">May 12, 2014</td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">TURN Extension for Third Party Authorization<br />
  <span class="filename">draft-reddy-tram-turn-third-party-authz-02</span></p>
  
  <h1 id="rfc.abstract">
  <a href="#rfc.abstract">Abstract</a>
</h1>
<p>This document proposes the use of OAuth to obtain and validate ephemeral tokens that can be used for TURN authentication. The usage of ephemeral tokens ensure that access to a TURN server can be controlled even if the tokens are compromised, as is the case in WebRTC where TURN credentials must be specified in Javascript.</p>
<h1 id="rfc.status">
  <a href="#rfc.status">Status of This Memo</a>
</h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet-Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<p>This Internet-Draft will expire on November 13, 2014.</p>
<h1 id="rfc.copyrightnotice">
  <a href="#rfc.copyrightnotice">Copyright Notice</a>
</h1>
<p>Copyright (c) 2014 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (http://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.  Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Introduction</a></li>
<li>2.   <a href="#rfc.section.2">Terminology</a></li>
<li>3.   <a href="#rfc.section.3">Solution Overview</a></li>
<li>4.   <a href="#rfc.section.4">Obtaining a Token Using OAuth</a></li>
<li>4.1.   <a href="#rfc.section.4.1">Key Establishment</a></li>
<li>4.1.1.   <a href="#rfc.section.4.1.1">DSKPP</a></li>
<li>4.1.2.   <a href="#rfc.section.4.1.2">HTTP interactions</a></li>
<li>4.1.3.   <a href="#rfc.section.4.1.3">Manual provisioning</a></li>
<li>5.   <a href="#rfc.section.5">Forming a Request</a></li>
<li>6.   <a href="#rfc.section.6">STUN Attributes</a></li>
<li>6.1.   <a href="#rfc.section.6.1">THIRD-PARTY-AUTHORIZATION</a></li>
<li>6.2.   <a href="#rfc.section.6.2">ACCESS-TOKEN</a></li>
<li>7.   <a href="#rfc.section.7">Receiving a request with ACCESS-TOKEN attribute</a></li>
<li>8.   <a href="#rfc.section.8">Changes to TURN Client</a></li>
<li>9.   <a href="#rfc.section.9">Security Considerations</a></li>
<li>10.   <a href="#rfc.section.10">IANA Considerations</a></li>
<li>11.   <a href="#rfc.section.11">Acknowledgements</a></li>
<li>12.   <a href="#rfc.references">References</a></li>
<li>12.1.   <a href="#rfc.references.1">Normative References</a></li>
<li>12.2.   <a href="#rfc.references.2">Informative References</a></li>
<li><a href="#rfc.authors">Authors' Addresses</a></li>


  </ul>

  <h1 id="rfc.section.1"><a href="#rfc.section.1">1.</a> <a href="#introduction" id="introduction">Introduction</a></h1>
<p id="rfc.section.1.p.1">Traversal Using Relay NAT (TURN) TURN <a href="#RFC5766">[RFC5766]</a> is a protocol that is often used to improve the connectivity of P2P applications. By providing a cloud-based relay service, TURN ensures that a connection can be established even when one or both sides is incapable of a direct P2P connection. However, as a relay service, it imposes a nontrivial cost on the service provider. Therefore, access to a TURN service is almost always access-controlled.</p>
<p id="rfc.section.1.p.2">TURN provides a mechanism to control access via "long-term" username/ password credentials that are provided as part of the TURN protocol. It is expected that these credentials will be kept secret; if the credentials are discovered, the TURN server could be used by unauthorized users or applications. However, in web applications, ensuring this secrecy is typically impossible. To address this problem and the ones described in <a href="#I-D.ietf-tram-auth-problems">[I-D.ietf-tram-auth-problems]</a>, this document proposes the use of third party authorization using OAuth for TURN.</p>
<p id="rfc.section.1.p.3">To achieve third party authorization, a resource owner e.g. WebRTC server, authorizes a TURN client to access resources on the TURN server.</p>
<p id="rfc.section.1.p.4">Using OAuth, a client obtains an ephemeral token from an authorization server e.g. WebRTC server, and the token is presented to the TURN server instead of the traditional mechanism of presenting username/password credentials. The TURN server validates the authenticity of the token and provides required services.</p>
<h1 id="rfc.section.2"><a href="#rfc.section.2">2.</a> <a href="#term" id="term">Terminology</a></h1>
<p id="rfc.section.2.p.1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in <a href="#RFC2119">[RFC2119]</a>.</p>
<p/>

<ul>
  <li>WebRTC Server: A web server that supports WebRTC <a href="#I-D.ietf-rtcweb-overview">[I-D.ietf-rtcweb-overview]</a>.</li>
  <li>Access Token: OAuth 2.0 access token.</li>
  <li>mac_key: The session key generated by the authorization server.  Note that the lifetime of the session key is equal to the lifetime of the access token.</li>
  <li>kid: An ephemeral and unique key identifier. The kid also allows the resource server to select the appropriate keying material for decryption.</li>
</ul>
<h1 id="rfc.section.3"><a href="#rfc.section.3">3.</a> <a href="#problem_stmt" id="problem_stmt">Solution Overview</a></h1>
<p id="rfc.section.3.p.1">This specification uses the token type 'Assertion' (aka self-contained token) described in <a href="#RFC6819">[RFC6819]</a> where all the information necessary to authenticate the validity of the token is contained within the token itself. This approach has the benefit of avoiding a protocol between the TURN server and the authorization server for token validation, thus reducing latency. The exact mechanism used by a client to obtain a token from the OAuth authorization server is outside the scope of this document. For example, a client could make an HTTP request to an authorization server to obtain a token that can be used to avail TURN services. The TURN token is returned in JSON, along with other OAuth Parameters like token type, mac_key, kid, token lifetime etc. The client is oblivious to the content of the token. The token is embedded within a TURN request sent to the TURN server. Once the TURN server has determined the token is valid, TURN services are offered for a determined period of time.</p>
<div id="rfc.figure.1"/>
<div id="figure1"/>
<pre>

+-------------------+                         +--------+  +---------+  
| .........  TURN   |                         |  TURN  |  |  WebRTC |
| .WebRTC .  Client |                         |        |  |         | 
| .Client .         |                         | Server |  |  Server |
| .........         |                         |        |  |         | 
+-------------------+                         +--------+  +---------+
  |       |           Allocate request                |         |
  |       |------------------------------------------&gt;|         |
  |       |                                           |         |
  |       |         Allocate error response           |         |
  |       |&lt;------------------------------------------|         |
  |       |         THIRD-PARTY-AUTHORIZATION         |         |  
  |       |                                           |         |                                      
  |       |                                           |         | 
  |       |      HTTP Request for token               |         |
  |------------------------------------------------------------&gt;|
  |       |      HTTP Response with token parameters  |         |
  |&lt;------------------------------------------------------------|
  |OAuth  |                                           |         |
   Attributes                                         |         |
  |------&gt;|                                           |         |
  |       |    Allocate request ACCESS-TOKEN          |         |
  |       |------------------------------------------&gt;|         |
  |       |                                           |         |
  |       |         Allocate success response         |         |
  |       |&lt;------------------------------------------|         |
  |       |             TURN Messages                 |         |
  |       |      ////// integrity protected //////    |         |
  |       |      ////// integrity protected //////    |         |
  |       |      ////// integrity protected //////    |         |
       </pre>
<p class="figure">Figure 1: TURN Third Party Authorization</p>
<p/>
<p id="rfc.section.3.p.3">Note : An implementation may choose to contact the WebRTC server to obtain a token even before it makes an allocate request, if it knows the server details before hand. For example, once a client has learnt that a TURN server supports Third Party authorization from a WebRTC server, the client can obtain the token before making subsequent allocate requests.</p>
<p id="rfc.section.3.p.4">For example, the client makes the following HTTP request for the access token using transport-layer security (with extra line breaks for display purposes only):</p>
<div id="rfc.figure.2"/>
<div id="Example1"/>
<p/>

<p/>
<pre>
     POST /o/oauth2/token HTTP/1.1 
     Audience: turnserver1.example.com
     Content-Type: application/x-www-form-urlencoded
     timestamp=1361471629
     grant_type=implicit
              </pre>
<p class="figure">Figure 2: Request</p>
<div id="rfc.figure.3"/>
<div id="Example2"/>
<p/>
<pre>
     HTTP/1.1 200 OK
     Content-Type: application/json
     Cache-Control: no-store

     {
       "access_token":
"U2FsdGVkX18qJK/kkWmRcnfHglrVTJSpS6yU32kmHmOrfGyI3m1gQj1jRPsr0uBb
HctuycAgsfRX7nJW2BdukGyKMXSiNGNnBzigkAofP6+Z3vkJ1Q5pWbfSRroOkWBn",
       "token_type":"mac",
       "expires_in":1800,
       "kid":"22BIjxU93h/IgwEb",
       "mac_key":"v51N62OM65kyMvfTI08O"
     }
              </pre>
<p class="figure">Figure 3: Response</p>
<p id="rfc.section.3.p.6">Access token and other attributes issued by the authorization server are explained in <a href="#token">Section 6.2</a>.</p>
<h1 id="rfc.section.4"><a href="#rfc.section.4">4.</a> <a href="#oauth" id="oauth">Obtaining a Token Using OAuth</a></h1>
<p id="rfc.section.4.p.1">A TURN client should know the authentication capability of the TURN server before deciding to use third party authorization with it. A TURN client initially makes a request without any authorization. If the TURN server supports or mandates third party authorization, it will return an error message indicating support for third party authorization. The TURN server includes an ERROR-CODE attribute with a value of 401 (Unauthorized), a nonce value in a NONCE attribute and a SOFTWARE attribute that gives information about the TURN server's software. The TURN servers also includes additional STUN attribute THIRD-PARTY-AUTHORIZATION signaling the TURN client that the TURN server supports third party authorization.</p>
<div id="rfc.figure.4"/>
<div id="oauth_webrtc_terminology_map"/>
<p>The following mapping of OAuth concepts to WebRTC is used :</p>
<pre>
              +----------------------+----------------------------+
              |         OAuth        |            WebRTC          |
              +======================+============================+
              | Client               | WebRTC client              |
              +----------------------+----------------------------+
              | Resource owner       | WebRTC server              |
              +----------------------+----------------------------+
              | Authorization server | Authorization server       |
              +----------------------+----------------------------+
              | Resource server      | TURN Server                |
              +----------------------+----------------------------+
              </pre>
<p class="figure">Figure 4: OAuth terminology mapped to WebRTC terminology</p>
<p id="rfc.section.4.p.2">Using the OAuth 2.0 authorization framework, a WebRTC client (third-party application) obtains limited access to a TURN (resource server) on behalf of the WebRTC server (resource owner or authorization server). The WebRTC client requests access to resources controlled by the resource owner (WebRTC server) and hosted by the resource server (TURN server). The WebRTC client obtains access token, lifetime, session key (in the mac_key parameter) and key id (kid). The TURN client conveys the access token and other OAuth parameters learnt from the authorization server to the resource server (TURN server). The TURN server obtains the session key from the access token. The TURN server validates the token, computes the message integrity of the request and takes appropriate action i.e permits the TURN client to create allocations. This is shown in an abstract way in <a href="#interactions">Figure 5</a>.</p>
<div id="rfc.figure.5"/>
<div id="interactions"/>
<pre>                        +---------------+
                        |               +&lt;******+
         +-------------&gt;| Authorization |       *
         |              | Server        |       *    
         |   +----------|(WebRTC Server)|       *  AS-RS,  
         |   |          |               |       *  AUTH keys    
(2)      |   |           +---------------+      *   (1)
Access   |   |  (3)                             *
Token    |   | Access Token                     *
Request  |   |    +                             *
         |   | Session Key                      *
         |   |                                  *
         |   V                                  V
     +-------+---+                       +-+----=-----+
     |           |         (4)           |            |
     |           | TURN Request + Access |            |
     | WebRTC    | Token                 | TURN       |
     | Client    |----------------------&gt;| Server     |
     | (Alice)   | Allocate Response     |            |
     |           |&lt;----------------------|            |
     +-----------+                       +------------+
                                                  
User : Alice
****: Out-of-Band Long-Term Key Establishment
</pre>
<p class="figure">Figure 5: Interactions</p>
<p/>
<p id="rfc.section.4.p.4">OAuth in <a href="#RFC6749">[RFC6749]</a> defines four grant types.  This specification uses the OAuth grant type "Implicit" explained in section 1.3.2 of <a href="#RFC6749">[RFC6749]</a> where the WebRTC client is issued an access token directly. The scope of the access token explained in section 3.3 of <a href="#RFC6749">[RFC6749]</a> MUST be TURN.</p>
<h1 id="rfc.section.4.1"><a href="#rfc.section.4.1">4.1.</a> Key Establishment</h1>
<p id="rfc.section.4.1.p.1">The TURN and authorization servers MUST establish a symmetric key (K), using an out of band mechanism. Symmetric key MUST be chosen to ensure that the size of encrypted token is not large because usage of asymmetric keys will result in large encrypted tokens which may not fit into a single STUN message. The AS-RS, AUTH keys will be derived from K. AS-RS key is used for encrypting the self-contained token and message integrity of the encrypted token is calculated using the AUTH key. The TURN and authorization servers MUST establish the symmetric key over an authenticated secure channel. The establishment of symmetric key is outside the scope of this specification. For example, implementations could use one of the following mechanisms in to establish a symmetric key.</p>
<h1 id="rfc.section.4.1.1"><a href="#rfc.section.4.1.1">4.1.1.</a> <a href="#DSKPP" id="DSKPP">DSKPP</a></h1>
<p id="rfc.section.4.1.1.p.1">The two servers could choose to use Dynamic Symmetric Key Provisioning Protocol <a href="#RFC6063">(DSKPP)</a> <cite title="NONE">[RFC6063]</cite> to establish a symmetric key (K). The encryption and MAC algorithms will be negotiated using the KeyProvClientHello, KeyProvServerHello messages. A unique key identifier (referred to as KeyID) for the symmetric key is generated by the DSKPP server (i.e. Authorization server) and signalled to the DSKPP client (i.e TURN server) which is equivalent to the kid defined in this specification. The AS-RS, AUTH keys would be derived from the symmetric key using (HMAC)-based key derivation function (HKDF) <a href="#RFC5869">(DSKPP)</a> <cite title="NONE">[RFC5869]</cite> and the default hash function is SHA-256. For example if the input symmetric key (K) is 32 octets length, encryption algorithm is AES_128_CBC and HMAC algorithm is HMAC-SHA-256-128 then the secondary keys AS-RS, AUTH are generated from the input key K as follows</p>
<p/>

<ol>
  <li>HKDF-Extract(zero, K) -&gt; PRK</li>
  <li>HKDF-Expand(PRK, zero, 8) -&gt; AS-RS key</li>
  <li>HKDF-Expand(PRK, zero, 16) -&gt; AUTH key</li>
</ol>
<p id="rfc.section.4.1.1.p.3">NOTE: If Authenticated Encryption with Associated Data (AEAD) algorithms <a href="#RFC5116">[RFC5116]</a> specified in <a href="#I-D.mcgrew-aead-aes-cbc-hmac-sha2">[I-D.mcgrew-aead-aes-cbc-hmac-sha2]</a> are used then there is no need to generate the AUTH key.</p>
<h1 id="rfc.section.4.1.2"><a href="#rfc.section.4.1.2">4.1.2.</a> <a href="#HTTP" id="HTTP">HTTP interactions</a></h1>
<p id="rfc.section.4.1.2.p.1">The two servers could choose to use REST API to establish a symmetric key. To retrieve a new symmetric key, the TURN server makes an HTTP GET request to the authorization server, specifying TURN as the service to allocate the symmetric keys for, and specifying the name of the TURN server. The response is returned with content-type "application/json", and consists of a JSON object containing the symmetric key.</p>
<pre>Request
-------

service - specifies the desired service (turn)
domain  -  TURN server name be associated with the key

example: GET /?service=turn&amp;domain=turnserver1.example.com


Response
--------

key - Long-term key (K)
ttl - the duration for which the key is valid, in seconds.

example:
{
   "key" : 
"ESIzRFVmd4iZABEiM0RVZgKn6WjLaTC1FXAghRMVTzkBGNaaN496523WIISKerLi",
   "ttl" : 86400,
   "kid" :"22BIjxU93h/IgwEb"
  }</pre>
<p/>
<p id="rfc.section.4.1.2.p.3">The AS-RS, AUTH keys are derived from K using HKDF as discussed in <a href="#DSKPP">Section 4.1.1</a>. Authorization server must also signal a unique key identifier (kid) to the TURN server which will be used to select the appropriate keying material for decryption.  The default encryption algorithm to encrypt the self-contained token could be Advanced Encryption Standard (AES) in Cipher Block Chaining (CBC) mode (AES_128_CBC). The default HMAC algorithm to calculate the integrity of the token could be HMAC-SHA-256-128. In this case AS-RS key length must be 128-bit, AUTH key length must be 256-bit (section 2.6 of <a href="#RFC4868">[RFC4868]</a>).</p>
<h1 id="rfc.section.4.1.3"><a href="#rfc.section.4.1.3">4.1.3.</a> <a href="#Manual" id="Manual">Manual provisioning</a></h1>
<p id="rfc.section.4.1.3.p.1">TURN and authorization servers could be manually configured with a symmetric key (K) and kid. The default encryption and HMAC algorithms could be AES_256_CBC, HMAC-SHA-256-128.</p>
<p id="rfc.section.4.1.3.p.2">Note : The mechanisms specified in <a href="#HTTP">Section 4.1.2</a> <a href="#Manual">Section 4.1.3</a> are easy to implement and deploy compared to DSKPP but lack encryption and HMAC algorithm agility.</p>
<h1 id="rfc.section.5"><a href="#rfc.section.5">5.</a> <a href="#Request" id="Request">Forming a Request</a></h1>
<p id="rfc.section.5.p.1">When a TURN server responds that third party authorization is required, a TURN client re-attempts the request, this time including access token and kid values in ACCESS-TOKEN and USERNAME STUN attributes. The TURN client includes a MESSAGE-INTEGRITY attribute as the last attribute in the message over the contents of the TURN message.  The HMAC for the MESSAGE-INTEGRITY attribute is computed as described in section 15.4 of <a href="#RFC5389">[RFC5389]</a> where the mac_key is used as the input key for the HMAC computation. The TURN client and server will use the mac_key to compute the message integrity and doesn't have to perform MD5 hash on the credentials.</p>
<h1 id="rfc.section.6"><a href="#rfc.section.6">6.</a> STUN Attributes</h1>
<p id="rfc.section.6.p.1">The following new STUN attributes are introduced by this specification to accomplish third party authorization.</p>
<h1 id="rfc.section.6.1"><a href="#rfc.section.6.1">6.1.</a> <a href="#attribute" id="attribute">THIRD-PARTY-AUTHORIZATION</a></h1>
<p id="rfc.section.6.1.p.1">This attribute is used by the TURN server to inform the client that it supports third party authorization. This attribute value contains the TURN server name. The TURN server may have tie-up with multiple authorization servers and vice versa, so the client MUST provide the TURN server name to the authorization server so that it can select the appropriate keying material to generate the self-contained token. The THIRD-PARTY-AUTHORIZATION attribute is a comprehension-optional attribute (see Section 15 from <a href="#RFC5389">[RFC5389]</a>).</p>
<h1 id="rfc.section.6.2"><a href="#rfc.section.6.2">6.2.</a> <a href="#token" id="token">ACCESS-TOKEN</a></h1>
<p id="rfc.section.6.2.p.1">The access token is issued by the authorization server. OAuth does not impose any limitation on the length of the access token but if path MTU is unknown then STUN messages over IPv4 would need to be less than 548 bytes (Section 7.1 of <a href="#RFC5389">[RFC5389]</a>), access token length needs to be restricted to fit within the maximum STUN message size. Note that the self-contained token is opaque to the client and it MUST NOT examine the ticket. The ACCESS-TOKEN attribute is a comprehension-optional attribute (see Section 15 from <a href="#RFC5389">[RFC5389]</a>).</p>
<p id="rfc.section.6.2.p.2">The token is structured as follows:</p>
<div id="rfc.figure.6"/>
<div id="token1"/>
<pre>      struct {
          opaque {
              ushort key_length;
              opaque mac_key[key_length];
              opaque timestamp[8];
              long   lifetime;
          } encrypted_block;
          opaque mac[16];
      } token;
</pre>
<p class="figure">Figure 6: Self-contained token format</p>
<p/>
<p id="rfc.section.6.2.p.4">The fields are described below:</p>
<p/>

<dl>
  <dt>key_length:</dt>
  <dd style="margin-left: 8">Length of the session key. Key length of 160-bits MUST be supported (i.e only 160-bit key is used by HMAC-SHA-1 for message integrity of STUN message). The key length facilitates the hash agility plan discussed in section 16.3 of <a href="#RFC5389">[RFC5389]</a>.</dd>
  <dt>mac_key:</dt>
  <dd style="margin-left: 8">The session key generated by the authorization server.</dd>
  <dt>Timestamp:</dt>
  <dd style="margin-left: 8">64-bit unsigned integer field containing a timestamp. The value indicates the time since January 1, 1970, 00:00 UTC, by using a fixed point format. In this format, the integer number of seconds is contained in the first 48 bits of the field, and the remaining 16 bits indicate the number of 1/64K fractions of a second (Native format - Unix).</dd>
  <dt>Lifetime:</dt>
  <dd style="margin-left: 8">The lifetime of the access token, in seconds. For example, the value 3600 indicates one hour. The Lifetime value SHOULD be equal to the "expires_in" parameter defined in section 4.2.2 of <a href="#RFC6749">[RFC6749]</a>.</dd>
  <dt>mac:</dt>
  <dd style="margin-left: 8">The Hashed Message Authentication Code (HMAC) is calculated with AUTH key over the encrypted portion of the token and the TURN server name (N) conveyed in the THIRD-PARTY-AUTHORIZATION response . Encryption is applied before authentication on the sender side and conversely on the receiver side.</dd>
</dl>
<p id="rfc.section.6.2.p.6">The encryption process can be illustrated as follows. Here C, N denote the ciphertext and TURN server name.</p>

<ul>
  <li>C = AES_128_CBC(AS-RS, encrypted_block)</li>
  <li>mac = HMAC-SHA-256-128(AUTH, C | | N)</li>
</ul>
<p/>
<p id="rfc.section.6.2.p.8">The token MUST be encoded as defined in Section 4 of <a href="#RFC4648">[RFC4648]</a> and then encrypted using the symmetric long-term key established between the resource server and the authorization server, as shown in <a href="#interactions">Figure 5</a> as AS-RS key. HMAC is computed using the encrypted portion of the token and TURN server name to ensure that the client does not use the same token to gain illegal access to other TURN servers provided by the same administrative domain. This attack is possible when multiple TURN servers in a single administrative domain share the same symmetric key with the authorization server. Since the access token is valid for a specific period of time the resource server MUST cache it so that it need not to be provided in every request within an existing allocation. The access token can be re-used for multiple Allocate requests to the same TURN server.</p>
<p id="rfc.section.6.2.p.9">The TURN client MUST include the ACCESS-TOKEN attribute only in Allocate and Refresh requests.</p>
<p id="rfc.section.6.2.p.10">Note : If Authenticated Encryption with Associated Data (AEAD) algorithm specified in <a href="#I-D.mcgrew-aead-aes-cbc-hmac-sha2">[I-D.mcgrew-aead-aes-cbc-hmac-sha2]</a> is used then there is no need to explicitly compute HMAC. In this scenario the associated data MUST be the TURN server name (N) and the mac field MUST carry the initialization vector (IV).</p>
<h1 id="rfc.section.7"><a href="#rfc.section.7">7.</a> <a href="#Response" id="Response">Receiving a request with ACCESS-TOKEN attribute</a></h1>
<p id="rfc.section.7.p.1">The TURN server, on receiving a request with ACCESS-TOKEN attribute, performs checks listed in section 10.2.2 of <a href="#RFC5389">[RFC5389]</a> in addition to the following steps to verify that the access token is valid:</p>
<p/>

<ul>
  <li>TURN server selects the keying material based on kid signalled in the USERNAME attribute.</li>
  <li>It performs the verification of the token message integrity by calculating HMAC over the encrypted portion in the self-contained token and TURN server name using AUTH key and if the resulting value does not match the mac field in the self-contained token then it rejects the request with an error response 401 (Unauthorized). Note : If AEAD algorithm is used then it has only a single output, either a plaintext or a special symbol FAIL that indicates that the inputs are not authentic.</li>
  <li>TURN server obtains the mac_key by retrieving the content of the access token (which requires decryption of the self-contained token using the AS-RS key).</li>
  <li>The TURN server verifies that no replay took place by performing the following check: <ul><li>The access token is accepted if the timestamp field in the self-contained token (TS) is recent enough to the reception time of the TURN request (RDnew) using the following formula: Lifetime + Delta &gt; abs(RDnew - TS). The RECOMMENDED value for the allowed Delta is 5 seconds. If the timestamp is NOT within the boundaries then the TURN server discards the request with error response 401 (Unauthorized).</li></ul></li>
  <li>The TURN server uses the mac_key to compute the message integrity over the request and if the resulting value does not match the contents of the MESSAGE-INTEGRITY attribute then it rejects the request with an error response 401 (Unauthorized).</li>
  <li>If all the checks pass, the TURN server continues to process the request. Any response generated by the server MUST include the MESSAGE-INTEGRITY attribute, computed using the mac_key.</li>
</ul>
<p id="rfc.section.7.p.3">The lifetime provided by the TURN server in the Allocate and Refresh responses MUST be less than or equal to the lifetime of the token.</p>
<h1 id="rfc.section.8"><a href="#rfc.section.8">8.</a> <a href="#client" id="client">Changes to TURN Client</a></h1>
<p/>

<ul>
  <li>A TURN response is discarded by the client if the value computed for message integrity using mac_key does not match the contents of the MESSAGE-INTEGRITY attribute.</li>
  <li>If the access token expires then the client MUST obtain a new token from the authorization server and use it for new allocations.  The client MUST also use the new token to refresh existing allocations. This way client has to maintain only one token per TURN server.</li>
</ul>
<h1 id="rfc.section.9"><a href="#rfc.section.9">9.</a> <a href="#security" id="security">Security Considerations</a></h1>
<p id="rfc.section.9.p.1">When OAuth is used the interaction between the client and the authorization server requires Transport Layer Security (TLS) with a ciphersuite offering confidentiality protection. The session key MUST NOT be transmitted in clear since this would completely destroy the security benefits of the proposed scheme. If an attacker tries to replay message with ACCESS-TOKEN attribute then the server can detect that the transaction id was used for an old request and thus prevent the replay attack.</p>
<p id="rfc.section.9.p.2">Security considerations discussed in <a href="#I-D.ietf-oauth-v2-http-mac">[I-D.ietf-oauth-v2-http-mac]</a> and <a href="#RFC5766">[RFC5766]</a> are to be taken into account.</p>
<h1 id="rfc.section.10"><a href="#rfc.section.10">10.</a> <a href="#iana" id="iana">IANA Considerations</a></h1>
<p id="rfc.section.10.p.1">IANA is requested to add the following attributes to the <a href="#iana-stun">STUN attribute registry</a> <cite title="NONE">[iana-stun]</cite>, </p>

<ul>
  <li>THIRD-PARTY-AUTHORIZATION</li>
  <li>ACCESS-TOKEN</li>
</ul>
<h1 id="rfc.section.11"><a href="#rfc.section.11">11.</a> <a href="#ack" id="ack">Acknowledgements</a></h1>
<p id="rfc.section.11.p.1">Authors would like to thank Dan Wing, Pal Martinsen and Oleg Moskalenko for comments and review. The authors would like to give special thanks to Brandon Williams for his help.</p>
<h1 id="rfc.references"><a href="#rfc.references">12.</a> References</h1>
<h1 id="rfc.references.1"><a href="#rfc.references.1">12.1.</a> Normative References</h1>
<table>
  <tbody>
    <tr>
      <td class="reference">
        <b id="RFC2119">[RFC2119]</b>
      </td>
      <td class="top"><a href="mailto:sob@harvard.edu" title="Harvard University">Bradner, S.</a>, "<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>", BCP 14, RFC 2119, March 1997.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC4648">[RFC4648]</b>
      </td>
      <td class="top"><a>Josefsson, S.</a>, "<a href="http://tools.ietf.org/html/rfc4648">The Base16, Base32, and Base64 Data Encodings</a>", RFC 4648, October 2006.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC4868">[RFC4868]</b>
      </td>
      <td class="top"><a>Kelly, S.</a> and <a>S. Frankel</a>, "<a href="http://tools.ietf.org/html/rfc4868">Using HMAC-SHA-256, HMAC-SHA-384, and HMAC-SHA-512 with IPsec</a>", RFC 4868, May 2007.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC5389">[RFC5389]</b>
      </td>
      <td class="top"><a>Rosenberg, J.</a>, <a>Mahy, R.</a>, <a>Matthews, P.</a> and <a>D. Wing</a>, "<a href="http://tools.ietf.org/html/rfc5389">Session Traversal Utilities for NAT (STUN)</a>", RFC 5389, October 2008.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC6749">[RFC6749]</b>
      </td>
      <td class="top"><a>Hardt, D.</a>, "<a href="http://tools.ietf.org/html/rfc6749">The OAuth 2.0 Authorization Framework</a>", RFC 6749, October 2012.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="iana-stun">[iana-stun]</b>
      </td>
      <td class="top"><a>IANA, </a>, "<a href="http://www.iana.org/assignments/stun-parameters/stun-pa rameters.xml">IANA: STUN Attributes</a>", April 2011.</td>
    </tr>
  </tbody>
</table>
<h1 id="rfc.references.2"><a href="#rfc.references.2">12.2.</a> Informative References</h1>
<table>
  <tbody>
    <tr>
      <td class="reference">
        <b id="I-D.ietf-oauth-v2-http-mac">[I-D.ietf-oauth-v2-http-mac]</b>
      </td>
      <td class="top"><a>Richer, J.</a>, <a>Mills, W.</a>, <a>Tschofenig, H.</a> and <a>P. Hunt</a>, "<a href="http://tools.ietf.org/html/draft-ietf-oauth-v2-http-mac-05">OAuth 2.0 Message Authentication Code (MAC) Tokens</a>", Internet-Draft draft-ietf-oauth-v2-http-mac-05, January 2014.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="I-D.ietf-rtcweb-overview">[I-D.ietf-rtcweb-overview]</b>
      </td>
      <td class="top"><a>Alvestrand, H.</a>, "<a href="http://tools.ietf.org/html/draft-ietf-rtcweb-overview-09">Overview: Real Time Protocols for Brower-based Applications</a>", Internet-Draft draft-ietf-rtcweb-overview-09, February 2014.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="I-D.ietf-tram-auth-problems">[I-D.ietf-tram-auth-problems]</b>
      </td>
      <td class="top"><a>Reddy, T.</a>, <a>R, R.</a>, <a>Perumal, M.</a> and <a>A. Yegin</a>, "<a href="http://tools.ietf.org/html/draft-ietf-tram-auth-problems-01">Problems with STUN long-term Authentication for TURN</a>", Internet-Draft draft-ietf-tram-auth-problems-01, May 2014.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="I-D.mcgrew-aead-aes-cbc-hmac-sha2">[I-D.mcgrew-aead-aes-cbc-hmac-sha2]</b>
      </td>
      <td class="top"><a>McGrew, D.</a>, <a>Foley, J.</a> and <a>K. Paterson</a>, "<a href="http://tools.ietf.org/html/draft-mcgrew-aead-aes-cbc-hmac-sha2-04">Authenticated Encryption with AES-CBC and HMAC-SHA</a>", Internet-Draft draft-mcgrew-aead-aes-cbc-hmac-sha2-04, February 2014.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC5116">[RFC5116]</b>
      </td>
      <td class="top"><a>McGrew, D.</a>, "<a href="http://tools.ietf.org/html/rfc5116">An Interface and Algorithms for Authenticated Encryption</a>", RFC 5116, January 2008.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC5766">[RFC5766]</b>
      </td>
      <td class="top"><a>Mahy, R.</a>, <a>Matthews, P.</a> and <a>J. Rosenberg</a>, "<a href="http://tools.ietf.org/html/rfc5766">Traversal Using Relays around NAT (TURN): Relay Extensions to Session Traversal Utilities for NAT (STUN)</a>", RFC 5766, April 2010.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC5869">[RFC5869]</b>
      </td>
      <td class="top"><a>Krawczyk, H.</a> and <a>P. Eronen</a>, "<a href="http://tools.ietf.org/html/rfc5869">HMAC-based Extract-and-Expand Key Derivation Function (HKDF)</a>", RFC 5869, May 2010.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC6063">[RFC6063]</b>
      </td>
      <td class="top"><a>Doherty, A.</a>, <a>Pei, M.</a>, <a>Machani, S.</a> and <a>M. Nystrom</a>, "<a href="http://tools.ietf.org/html/rfc6063">Dynamic Symmetric Key Provisioning Protocol (DSKPP)</a>", RFC 6063, December 2010.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC6819">[RFC6819]</b>
      </td>
      <td class="top"><a>Lodderstedt, T.</a>, <a>McGloin, M.</a> and <a>P. Hunt</a>, "<a href="http://tools.ietf.org/html/rfc6819">OAuth 2.0 Threat Model and Security Considerations</a>", RFC 6819, January 2013.</td>
    </tr>
  </tbody>
</table>
<h1 id="rfc.authors">
  <a href="#rfc.authors">Authors' Addresses</a>
</h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Tirumaleswar Reddy</span> 
	  <span class="n hidden">
		<span class="family-name">Reddy</span>
	  </span>
	</span>
	<span class="org vcardline">Cisco Systems, Inc.</span>
	<span class="adr">
	  <span class="vcardline">Cessna Business Park, Varthur Hobli</span>
<span class="vcardline">Sarjapur Marathalli Outer Ring Road</span>

	  <span class="vcardline">
		<span class="locality">Bangalore</span>,  
		<span class="region">Karnataka</span> 
		<span class="code">560103</span>
	  </span>
	  <span class="country-name vcardline">India</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:tireddy@cisco.com">tireddy@cisco.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Prashanth Patil</span> 
	  <span class="n hidden">
		<span class="family-name">Patil</span>
	  </span>
	</span>
	<span class="org vcardline">Cisco Systems, Inc.</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality">Bangalore</span>,  
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline">India</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:praspati@cisco.com">praspati@cisco.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Ram Mohan Ravindranath</span> 
	  <span class="n hidden">
		<span class="family-name">Ravindranath</span>
	  </span>
	</span>
	<span class="org vcardline">Cisco Systems, Inc.</span>
	<span class="adr">
	  <span class="vcardline">Cessna Business Park,</span>
<span class="vcardline">Kadabeesanahalli Village, Varthur Hobli,</span>
<span class="vcardline">Sarjapur-Marathahalli Outer Ring Road</span>

	  <span class="vcardline">
		<span class="locality">Bangalore</span>,  
		<span class="region">Karnataka</span> 
		<span class="code">560103</span>
	  </span>
	  <span class="country-name vcardline">India</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:rmohanr@cisco.com">rmohanr@cisco.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Justin Uberti</span> 
	  <span class="n hidden">
		<span class="family-name">Uberti</span>
	  </span>
	</span>
	<span class="org vcardline">Google</span>
	<span class="adr">
	  <span class="vcardline">747 6th Ave S</span>
<span class="vcardline">Kirkland, WA</span>

	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code">98033</span>
	  </span>
	  <span class="country-name vcardline">USA</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:justin@uberti.name">justin@uberti.name</a></span>

  </address>
</div>

</body>
</html>
